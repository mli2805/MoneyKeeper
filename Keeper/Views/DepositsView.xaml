<Window x:Class="Keeper.Views.DepositsView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="DepositsView" Height="600" Width="940"
        xmlns:chartingToolkit="clr-namespace:System.Windows.Controls.DataVisualization.Charting;assembly=System.Windows.Controls.DataVisualization.Toolkit"
        xmlns:cal="http://www.caliburnproject.org">
  <Window.Resources>
    <ResourceDictionary>
      <DataTemplate x:Key="StartAmountColumnStyle">
        <TextBlock HorizontalAlignment="Right">
          <TextBlock.Text>
            <Binding Path="StartAmount" StringFormat="{}{0:#,0;; }"/>
          </TextBlock.Text>
        </TextBlock>
      </DataTemplate>
      <DataTemplate x:Key="AdditionalAmountsColumnStyle">
        <TextBlock HorizontalAlignment="Right">
          <TextBlock.Text>
            <Binding Path="AdditionalAmounts" StringFormat="{}{0:#,0;; }"/>
          </TextBlock.Text>
        </TextBlock>
      </DataTemplate>
      <DataTemplate x:Key="CurrentBalanceColumnStyle">
        <TextBlock HorizontalAlignment="Right">
          <TextBlock.Text>
            <Binding Path="CurrentBalance" StringFormat="{}{0:#,0;; }"/>
          </TextBlock.Text>
        </TextBlock>
      </DataTemplate>
      <DataTemplate x:Key="ProfitColumnStyle">
        <TextBlock HorizontalAlignment="Right">
          <TextBlock.Text>
            <Binding Path="Profit" StringFormat="{}{0:#,0;; }"/>
          </TextBlock.Text>
        </TextBlock>
      </DataTemplate>
      <DataTemplate x:Key="ForecastColumnStyle">
        <TextBlock HorizontalAlignment="Right">
          <TextBlock.Text>
            <Binding Path="Forecast" StringFormat="{}{0:#,0;; }"/>
          </TextBlock.Text>
        </TextBlock>
      </DataTemplate>
    </ResourceDictionary>
  </Window.Resources>
  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="30*"/>
      <ColumnDefinition Width="70*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height="149*"/>
      <RowDefinition Height="10"/>
      <RowDefinition Height="121*"/>
    </Grid.RowDefinitions>
    <ListView Margin="2" Grid.ColumnSpan="2"
              ItemsSource="{Binding DepositsList}" SelectedItem="{Binding SelectedDeposit}"
              cal:Message.Attach="[Event MouseDoubleClick] = [Action ShowSelectedDeposit()]" >
      <ListView.ItemContainerStyle>
        <Style TargetType="{x:Type ListViewItem}">
          <Setter Property="Foreground" Value="{Binding FontColor}"/>
          <Setter Property="BorderBrush" Value="LightGray"/>
          <Setter Property="BorderThickness" Value="0,0,0,1"/>
        </Style>
      </ListView.ItemContainerStyle>
      <ListView.View>
        <GridView>
          <GridViewColumn Header="Наименование" Width="350" DisplayMemberBinding="{Binding Account}" />
          <GridViewColumn Header="Вал"            Width="40" DisplayMemberBinding="{Binding MainCurrency}" />
          <GridViewColumn Header="Сумма открытия" Width="100" CellTemplate="{StaticResource StartAmountColumnStyle}" />
          <GridViewColumn Header="Доп взносы"     Width="100" CellTemplate="{StaticResource AdditionalAmountsColumnStyle}" />
          <GridViewColumn Header="Текущий остаток" Width="100" CellTemplate="{StaticResource CurrentBalanceColumnStyle}" />
          <GridViewColumn Header="Прибыль"        Width="100" CellTemplate="{StaticResource ProfitColumnStyle}" />
          <GridViewColumn Header="Прогноз"        Width="100" CellTemplate="{StaticResource ForecastColumnStyle}" />
        </GridView>
      </ListView.View>
    </ListView>
    <GridSplitter Background="LightGray" Margin="2,0" Height="10" Grid.Row="1" Grid.ColumnSpan="2" 
                  HorizontalAlignment="Stretch" VerticalAlignment="Center" BorderThickness="1" BorderBrush="AliceBlue" />
    <chartingToolkit:Chart Margin="-8,-10,-8,-20" Grid.Row="2" BorderThickness="0"
                           Title="Сумма депозитов на текущий момент:" TitleStyle="{Binding MyTitleStyle}">
      <chartingToolkit:PieSeries
        DependentValuePath="Amount" IndependentValuePath="Subject" 
        ItemsSource="{Binding TotalsList}" 
		IsSelectionEnabled="True"/>
    </chartingToolkit:Chart>
    <chartingToolkit:Chart Margin="0,-10,-110,-20" Grid.Row="2" Grid.Column="1" BorderThickness="0"
                           Title="Суммы дохода по годам начисления (не выплаты)" TitleStyle="{Binding MyTitleStyle}">
      <chartingToolkit:ColumnSeries
        DependentValuePath="Amount" IndependentValuePath="Subject" 
        ItemsSource="{Binding YearsList}" 
		IsSelectionEnabled="True"/>
    </chartingToolkit:Chart>
  </Grid>
</Window>
